<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Your name here" />
  <title>Tutorial: High-performance computing</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="styles/github-pandoc.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Tutorial: High-performance computing</h1>
<p class="author">Your name here</p>
</header>
<h1 id="high-performance-computing">High-performance computing</h1>
<p>High-performance computing (HPC) typically refers to using parallel
data processing across multiple computers in order to analyze large data
sets in a timely manner. HPC works well for many bioinformatics
applications, because many of the analysis steps can proceed
independently (e.g. at the same time on different computers).</p>
<h3 id="running-an-interactive-job">Running an interactive job</h3>
<p>Due to the possibility of being disconnected from the cluster, you
may want to use <code>tmux</code> or <code>screen</code> when running
interactive jobs. These programs allow you to disconnect from a terminal
session and reconnect later. For example, before requesting the
interactive job create a <code>tmux</code> session:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> tmux new <span class="at">-s</span> myjob</span></code></pre></div>
<p>This will create a new <code>tmux</code> session named
<code>myjob</code>. You can then request the interactive job and run
your commands. If you are disconnected (or if you detach using
<code>Ctrl + b</code> then <code>d</code>) you can reattach to the
<code>tmux</code> session:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> tmux attach <span class="at">-t</span> myjob</span></code></pre></div>
<p>Note that there may be multiple login nodes, and you may be connected
to a different login node when you reconnect. If you are unable to
reconnect to the <code>tmux</code> session, try connecting to a
different login node. For example, if you were on the
<code>cedar1</code> login node when you created the <code>tmux</code>
session, but are now on the <code>cedar5</code> login node, you can
quickly switch to the <code>cedar1</code> login node using
<code>ssh cedar1</code>.</p>
<p>If you find that you are frequently disconnected from the cluster,
try adding the following to the <code>~/.ssh/config</code> file
<strong>on your computer</strong> before connecting to the cluster:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode texinfo"><code class="sourceCode texinfo"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Host *</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    ServerAliveInterval 300</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    ServerAliveCountMax 5</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    TCPKeepAlive yes</span></code></pre></div>
<p>On the login node request an interactive job:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/scratch</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> salloc <span class="at">--account</span><span class="op">=</span>def-<span class="va">${USER}</span> <span class="dt">\</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>--time=2:0:0 <span class="dt">\</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>--ntasks=2 <span class="dt">\</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>--mem-per-cpu=8000M</span></code></pre></div>
<figure>
<img src="includes/f1e14fc4bb9cb70f88743f7405bb8115.png"
alt="Requesting an interactive job" />
<figcaption aria-hidden="true">Requesting an interactive
job</figcaption>
</figure>
<p>The <code>salloc</code> options mean the following:</p>
<table>
<thead>
<tr class="header">
<th>Option</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>–account=def-someuser</td>
<td>Use the default allocation for this user</td>
</tr>
<tr class="even">
<td>–time=2:0:0</td>
<td>Reserve the compute node for 2 hours</td>
</tr>
<tr class="odd">
<td>–ntasks=2</td>
<td>Reserve 2 CPU cores</td>
</tr>
<tr class="even">
<td>–mem-per-cpu=8000M</td>
<td>Reserve 8000MB of RAM per CPU</td>
</tr>
</tbody>
</table>
<p>You can request longer times and more RAM and CPU resources. However,
the more you request the more likely your <code>salloc</code> command
will leave you waiting for the resources to become available.</p>
<p>Once the allocation is available you will be logged in to a compute
node where you are free to run your commands. You will have access to
the same files and folders as on the login node, and any files you
create on a compute node will be accessible afterwards from the login
node.</p>
<p>Typically you work within the <code>~/scratch</code> folder when
using compute nodes, hence the <code>cd ~/scratch</code> prior to
requesting the allocation. When you exit the compute node you can
continue to access the contents of this folder from the login node. Note
that the contents of <code>~/scratch</code> are regularly removed by
administrators (with warning) so don’t use it for long-term storage.
Place files that you want to keep in your <code>project</code> folder.
Each research group is given a default allocation of 1 TB of “project”
storage.</p>
<p>To use a module, e.g. <code>emboss</code>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> module load emboss</span></code></pre></div>
<p>Once loaded you can use the usual commands for that package,
e.g.:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> stretcher <span class="at">-version</span></span></code></pre></div>
<figure>
<img src="includes/8b34ca6395ccb10c357c9f19a159fbaa.png"
alt="Loading a module" />
<figcaption aria-hidden="true">Loading a module</figcaption>
</figure>
<p>Download some data using the following command:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> wget <span class="dt">\</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;https://www.dropbox.com/scl/fi/5xlcbo077xr4ct5uo0bje/hpc_tutorial.zip?rlkey=graq</span><span class="dt">\</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">a6rgb9j45fn79bay3mirb&amp;dl=0&quot;</span> <span class="dt">\</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>-O hpc_tutorial.zip</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> unzip hpc_tutorial.zip</span></code></pre></div>
<p>Licensed under <a
href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a></p>
</body>
</html>
